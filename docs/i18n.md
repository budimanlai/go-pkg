# I18n Package Documentation

Paket i18n ini menyediakan manajemen internasionalisasi (i18n) untuk aplikasi Go, menggunakan library `github.com/nicksnyder/go-i18n/v2/i18n`.

## Instalasi

Pastikan Anda memiliki dependensi yang diperlukan:

```bash
go get github.com/nicksnyder/go-i18n/v2/i18n
go get golang.org/x/text/language
```

## Struktur File

- `i18n.go`: Kode utama untuk I18nManager
- `i18n_test.go`: Unit tests
- `locales/`: Folder berisi file JSON untuk setiap bahasa
  - `en.json`: Pesan dalam bahasa Inggris
  - `id.json`: Pesan dalam bahasa Indonesia
  - `zh.json`: Pesan dalam bahasa Cina

## Konfigurasi

Untuk menggunakan paket ini, buat konfigurasi `I18nConfig`:

```go
import (
    "github.com/budimanlai/go-pkg/i18n"
    "golang.org/x/text/language"
)

i18nConfig := i18n.I18nConfig{
    DefaultLanguage: language.Indonesian,  // Bahasa default
    SupportedLangs:  []string{"en", "id", "zh"},  // Bahasa yang didukung
    LocalesPath:     "locales",  // Path ke folder locales
}
```

## Penggunaan

### Membuat I18nManager

```go
i18nManager, err := i18n.NewI18nManager(i18nConfig)
if err != nil {
    panic(err)
}
```

### Menerjemahkan Pesan Sederhana

```go
// Tanpa template
welcomeID := i18nManager.Translate("id", "welcome", nil)
welcomeEN := i18nManager.Translate("en", "welcome", nil)

// Output:
// Selamat datang di aplikasi kami!
// Welcome to our application!
```

### Menerjemahkan Pesan dengan Template

```go
// Dengan template
helloID := i18nManager.Translate("id", "hello_name", map[string]interface{}{"Name": "Budiman"})
helloEN := i18nManager.Translate("en", "hello_name", map[string]interface{}{"Name": "Budiman"})

// Output:
// Halo, Budiman!
// Hello, Budiman!
```

### Menggunakan dengan Fiber Framework

Jika menggunakan Fiber, Anda bisa menggunakan `NewI18nManagerWithFiber`:

```go
app := fiber.New()

i18nManager, err := i18n.NewI18nManagerWithFiber(app, i18nConfig)
if err != nil {
    panic(err)
}
```

Ini akan menambahkan middleware i18n ke aplikasi Fiber.

## File Locales

File locales adalah file JSON yang berisi pasangan key-value untuk pesan terjemahan.

Contoh `locales/en.json`:

```json
{
    "welcome": "Welcome to our application!",
    "hello_name": "Hello, {{.Name}}!"
}
```

Contoh `locales/id.json`:

```json
{
    "welcome": "Selamat datang di aplikasi kami!",
    "hello_name": "Halo, {{.Name}}!",
    "selamat_pagi": "Selamat pagi"
}
```

- Key adalah identifier pesan (message ID)
- Value adalah teks terjemahan
- Template menggunakan `{{.Variable}}` untuk placeholder

## Fallback dan Error Handling

- Jika pesan tidak ditemukan dalam bahasa yang diminta, akan fallback ke bahasa default
- Jika pesan tidak ditemukan di bahasa default, akan mengembalikan pesan error dengan format: "Missing translation for [lang]: [messageID]"

Contoh:

```go
missingEN := i18nManager.Translate("en", "selamat_pagi", nil)
// Output: Missing translation for en: selamat_pagi

missingID := i18nManager.Translate("id", "selamat_pagi", nil)
// Output: Selamat pagi (karena ada di id.json)
```

## Testing

Jalankan unit tests dengan:

```bash
go test ./i18n
```

Tests mencakup:
- Pembuatan I18nManager
- Terjemahan pesan sederhana dan dengan template
- Fallback ke bahasa default
- Penanganan pesan yang hilang

## Contoh Lengkap

```go
package main

import (
    "fmt"
    pkg_i18n "github.com/budimanlai/go-pkg/i18n"
    "golang.org/x/text/language"
)

func main() {
    i18nConfig := pkg_i18n.I18nConfig{
        DefaultLanguage: language.Indonesian,
        SupportedLangs:  []string{"en", "id", "zh"},
        LocalesPath:     "locales",
    }

    i18n, err := pkg_i18n.NewI18nManager(i18nConfig)
    if err != nil {
        panic(err)
    }

    // Contoh penggunaan
    fmt.Println("Welcome in ID:", i18n.Translate("id", "welcome", nil))
    fmt.Println("Welcome in EN:", i18n.Translate("en", "welcome", nil))
    fmt.Println("Hallo Name in ID:", i18n.Translate("id", "hello_name", map[string]interface{}{"Name": "Budiman"}))
    fmt.Println("Missing in EN:", i18n.Translate("en", "selamat_pagi", nil))
}
```